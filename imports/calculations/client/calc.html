<template name="results">
  <h2> Results </h2>
  pdf: <a href="{{pdfUrl calc}}" target="_blank">plot.pdf</a><br/>
  csvs: <a href="{{resultsUrl calc}}" target="_blank">Results Directory</a><br/>
  Logs: <a href="{{logUrl calc}}" target="_blank">Logs</a><br/>
  <br/>

  Queued at:  {{calc.queueTime}}<br/>
  Started:  {{calc.startTime}}<br/>
  Finished:  {{calc.endTime}}<br/>
  <br/>
  Duration: {{duration calc}}
</template>

<template name="calculations">
<h1>
  Calculation List
</h1>
{{#if Template.subscriptionsReady}}

<ul>
{{#each calc in calcList}}
  <li>
    {{>calc_list_item calc = calc}}
  </li>
{{/each}}
</ul>

{{else}}
  Loading... please wait
{{/if}}

</template>

<template name="calc_list_item">
 <A href="{{flowPath 'calculation' calc._id}}">{{calc.name}}</A>
    {{#if expanded}}
      <button>-</button>
    {{else}}
      <button>+</button>
    {{/if}}
    {{#if expanded}}
      {{>scheme_calc_list schemeId=calc.schemeId}}
    {{/if}}
</template>

<template name="scheme_calc_list">
  <ul>
    {{#each calc in scheme_calcs}}
    <li>
      <A href="{{flowPath 'calculation' calc._id}}">{{calc.name}}</A>
    </li>
    {{/each}}
  </ul>
</template>

<template name="calculation">
{{#if Template.subscriptionsReady}}

{{#let calc = getCalc}}


<h1>
  Calculation: <a href="{{flowPath 'scheme_backup_id' calc.historyId }}">{{calc.name}}</a>
  - <b>{{status calc}}</b>
</h1>

  {{#if calc.endTime}}
    {{> results calc = calc}}
  {{/if}}

  <br/>
  <br/>

  <b>StdOut</b>
  <pre>
  <b>Crosser:</b>
  <br/>{{calc.crossStdOut}}
  <br/>
  <b>R:</b>
  <br/>{{calc.rStdOut}}
  </pre>

  <b>StdErr</b>
  <pre>
  <b>Crosser:</b>
  <br/>{{calc.crossStdErr}}
  <br/>
  <b>R:</b>
  <br/>{{calc.rStdErr}}
  </pre>

{{/let}}
{{/if}}
</template>
